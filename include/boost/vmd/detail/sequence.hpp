#if !defined(BOOST_VMD_DETAIL_SEQUENCE_HPP)
#define BOOST_VMD_DETAIL_SEQUENCE_HPP

#include <boost/preprocessor/arithmetic/inc.hpp>
#include <boost/preprocessor/array/push_back.hpp>
#include <boost/preprocessor/cat.hpp>
#include <boost/preprocessor/comparison/equal.hpp>
#include <boost/preprocessor/comparison/greater.hpp>
#include <boost/preprocessor/comparison/less_equal.hpp>
#include <boost/preprocessor/comparison/not_equal.hpp>
#include <boost/preprocessor/control/expr_iif.hpp>
#include <boost/preprocessor/control/iif.hpp>
#include <boost/preprocessor/control/while.hpp>
#include <boost/preprocessor/list/append.hpp>
#include <boost/preprocessor/logical/bitand.hpp>
#include <boost/preprocessor/logical/bitnor.hpp>
#include <boost/preprocessor/logical/bitor.hpp>
#include <boost/preprocessor/logical/not.hpp>
#include <boost/preprocessor/punctuation/is_begin_parens.hpp>
#include <boost/preprocessor/seq/elem.hpp>
#include <boost/preprocessor/seq/push_back.hpp>
#include <boost/preprocessor/seq/size.hpp>
#include <boost/preprocessor/tuple/elem.hpp>
#include <boost/preprocessor/tuple/enum.hpp>
#include <boost/preprocessor/tuple/push_back.hpp>
#include <boost/preprocessor/tuple/replace.hpp>
#include <boost/preprocessor/tuple/size.hpp>
#include <boost/preprocessor/variadic/elem.hpp>
#include <boost/preprocessor/variadic/size.hpp>
#include <boost/vmd/array.hpp>
#include <boost/vmd/empty.hpp>
#include <boost/vmd/identifier.hpp>
#include <boost/vmd/identity.hpp>
#include <boost/vmd/is_empty.hpp>
#include <boost/vmd/list.hpp>
#include <boost/vmd/number.hpp>
#include <boost/vmd/seq.hpp>
#include <boost/vmd/tuple.hpp>
#include <boost/vmd/types.hpp>
#include <boost/vmd/detail/empty_result.hpp>
#include <boost/vmd/detail/mods.hpp>
#include <boost/vmd/detail/variadic_pop_front.hpp>

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT_ELEM 0
#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ELEM 1
#define BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM_ELEM 2
#define BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE_ELEM 3
#define BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM_ELEM 4
#define BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES_ELEM 5
#define BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX_ELEM 6

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state) \
	BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state) \
	BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state) \
		BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE(state) \
		BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
		BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_RETURN(from,number) \
	BOOST_PP_EQUAL \
		( \
		BOOST_PP_TUPLE_ELEM(0,from), \
		number \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_NO_RETURN(from) \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_RETURN(from,BOOST_VMD_DETAIL_MODS_NO_RETURN) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_EXACT_RETURN(from) \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_RETURN(from,BOOST_VMD_DETAIL_MODS_RETURN) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_GENERAL_RETURN(from) \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_RETURN(from,BOOST_VMD_DETAIL_MODS_RETURN_TUPLE) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_ARRAY_RETURN(from) \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_RETURN(from,BOOST_VMD_DETAIL_MODS_RETURN_ARRAY) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_LIST_RETURN(from) \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_RETURN(from,BOOST_VMD_DETAIL_MODS_RETURN_LIST) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_AFTER(from) \
	BOOST_PP_EQUAL \
		( \
		BOOST_PP_TUPLE_ELEM(1,from), \
		BOOST_VMD_DETAIL_MODS_RETURN_AFTER \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state) \
		BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state) \
		BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX_ELEM,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_IS_EMPTY(state) \
	BOOST_VMD_IS_EMPTY \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_FROM_EMPTY(state,data) \
	(data) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_TO_SEQ(state,data) \
	BOOST_PP_SEQ_PUSH_BACK(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state),data) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_TO_TUPLE(state,data) \
	BOOST_PP_TUPLE_PUSH_BACK(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state),data) \
/**/

// Array

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_2(state,data) \
	BOOST_PP_ARRAY_PUSH_BACK(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state),data) \
/**/

// List

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_3(state,data) \
	BOOST_PP_LIST_APPEND(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state),(data,BOOST_PP_NIL)) \
/**/

// Seq

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_4(state,data) \
	BOOST_PP_IIF \
	 	( \
	 	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_IS_EMPTY(state), \
	 	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_FROM_EMPTY, \
	 	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_TO_SEQ \
	 	) \
	 (state,data) \
/**/

// Tuple

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_5(state,data) \
	BOOST_PP_IIF \
	 	( \
	 	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_IS_EMPTY(state), \
	 	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_FROM_EMPTY, \
	 	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_TO_TUPLE \
	 	) \
	 (state,data) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_GET_NAME(state) \
	BOOST_PP_CAT \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_, \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_PROCESS(name,state,data) \
	name(state,data) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_GET_IDATA(state,tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_NO_RETURN \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
			), \
		BOOST_PP_TUPLE_ELEM, \
		BOOST_VMD_IDENTITY(tuple) \
		) \
	(1,tuple) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_GET_DATA(state,tuple) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_GET_IDATA(state,tuple)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD(state,ttuple) \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_PROCESS \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_GET_NAME(state), \
		state, \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD_GET_DATA(state,ttuple) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PROCESSING_ELEM_CHECK(d,state) \
	BOOST_PP_EQUAL_D \
		( \
		d, \
		BOOST_PP_SEQ_SIZE(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state)), \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PROCESSING_IELEM(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state)), \
		BOOST_VMD_IDENTITY(0), \
		BOOST_VMD_DETAIL_SEQUENCE_PROCESSING_ELEM_CHECK \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PROCESSING_ELEM(d,state) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_PROCESSING_IELEM(d,state)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_GET_TYPE(state) \
		BOOST_PP_TUPLE_ELEM \
			( \
			0, \
			BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state),BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state)) \
			) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_STATE_GET_TYPE_REENTRANT(state) \
		BOOST_PP_TUPLE_ELEM \
			( \
			1, \
			BOOST_PP_TUPLE_ELEM(BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state),BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state)) \
			) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_UNKNOWN(d,state) \
	( \
	, \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD(state,(BOOST_VMD_TYPE_UNKNOWN,BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state))), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state), \
	BOOST_PP_INC(BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state)) \
	) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_GET_FULL_TYPE(state) \
	BOOST_PP_CAT \
		( \
		BOOST_VMD_TYPE_, \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_GET_TYPE(state) \
		) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_PROCESS(state,tuple) \
	( \
	BOOST_PP_TUPLE_ELEM(1,tuple), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD \
		( \
		state, \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_GET_FULL_TYPE(state), \
			BOOST_PP_TUPLE_ELEM(0,tuple) \
			) \
		), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state), \
	BOOST_PP_INC(BOOST_PP_TUPLE_SIZE(BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state))) \
	) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_SEQ_SINGLE(tuple) \
	BOOST_PP_EQUAL(BOOST_PP_SEQ_SIZE(BOOST_PP_TUPLE_ELEM(0,tuple)),1) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_ISEQ(state,tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_EQUAL \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_GET_FULL_TYPE(state), \
			BOOST_VMD_TYPE_SEQ \
			), \
		BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_SEQ_SINGLE, \
		BOOST_VMD_IDENTITY(0) \
		) \
	(tuple) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_SEQ(state,tuple) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_ISEQ(state,tuple)) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND(state,tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_SEQ(state,tuple), \
		BOOST_VMD_DETAIL_SEQUENCE_INCREMENT_INDEX, \
		BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND_PROCESS \
		) \
	(state,tuple) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_INCREMENT_INDEX(state,tuple) \
	BOOST_PP_TUPLE_REPLACE(state,BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX_ELEM,BOOST_PP_INC(BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state))) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE_TUPLE(state,tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY \
			( \
			BOOST_PP_TUPLE_ELEM(0,tuple) \
			), \
		BOOST_VMD_DETAIL_SEQUENCE_INCREMENT_INDEX, \
		BOOST_VMD_DETAIL_SEQUENCE_TYPE_FOUND \
		) \
	(state,tuple) \
/**/

#define	BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE(d,call,state) \
	BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE_TUPLE \
		( \
		state, \
		call(BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state),BOOST_VMD_RETURN_AFTER) \
		) \
/**/
	
#define	BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE_D(d,call,state) \
	BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE_TUPLE \
		( \
		state, \
		call(d,BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state),BOOST_VMD_RETURN_AFTER) \
		) \
/**/
	
#define BOOST_VMD_DETAIL_SEQUENCE_GCLRT(state) \
	BOOST_PP_CAT \
		( \
		BOOST_VMD_BEGIN_, \
		BOOST_PP_CAT(BOOST_VMD_DETAIL_SEQUENCE_STATE_GET_TYPE(state),_D) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_GCLPL(state) \
	BOOST_PP_CAT \
		( \
		BOOST_VMD_BEGIN_, \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_GET_TYPE(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST_GCL(state,rflag) \
	BOOST_PP_IIF \
		( \
		rflag, \
		BOOST_VMD_DETAIL_SEQUENCE_GCLRT, \
		BOOST_VMD_DETAIL_SEQUENCE_GCLPL \
		) \
	(state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST_RT_CALL(d,call,state,rflag) \
	BOOST_PP_IIF \
		( \
		rflag, \
		BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE_D, \
		BOOST_VMD_DETAIL_SEQUENCE_TEST_TYPE \
		) \
	(d,call,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST_RT(d,state,rflag) \
	BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST_RT_CALL \
		( \
		d, \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST_GCL(state,rflag), \
		state, \
		rflag \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST(d,state) \
	BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST_RT \
		( \
		d, \
		state, \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_GET_TYPE_REENTRANT(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_OP(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_EQUAL \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state), \
			BOOST_PP_TUPLE_SIZE(BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state)) \
			), \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_UNKNOWN, \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_OP_TEST \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_INNER_PRED(d,state) \
	BOOST_PP_NOT_EQUAL \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_INDEX(state), \
		BOOST_PP_INC(BOOST_PP_TUPLE_SIZE(BOOST_VMD_DETAIL_SEQUENCE_STATE_TYPES(state))) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ELEM_FROM(d,from) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_GENERAL_RETURN(from), \
		((SEQ,1),(TUPLE,0)), \
		BOOST_PP_IIF \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_EXACT_RETURN(from), \
			((SEQ,1),(LIST,1),(ARRAY,0),(TUPLE,0)), \
			BOOST_PP_IIF \
				( \
				BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_ARRAY_RETURN(from), \
				((SEQ,1),(ARRAY,0),(TUPLE,0)), \
				BOOST_PP_IIF \
					( \
					BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_LIST_RETURN(from), \
					((SEQ,1),(LIST,1),(TUPLE,0)), \
					((SEQ,1),(TUPLE,0)) \
					) \
				) \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ELEM(d,state) \
	BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ELEM_FROM \
		( \
		d, \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY_NOE_CHC(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_GENERAL_RETURN(BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state)), \
		((SEQ,1),(TUPLE,0)), \
		((SEQ,1),(LIST,1),(ARRAY,0),(TUPLE,0)) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY_INOE(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_NO_RETURN \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
			), \
		BOOST_VMD_IDENTITY(((SEQ,1),(LIST,1),(ARRAY,0),(TUPLE,0))), \
		BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY_NOE_CHC \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY_NOE(d,state) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY_INOE(d,state)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_IANY(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state) \
			), \
		BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY_NOE, \
		BOOST_VMD_IDENTITY(((SEQ,1),(TUPLE,0))) \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY(d,state) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_IANY(d,state)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_PROCESSING_ELEM(d,state), \
		BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ELEM, \
		BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES_ANY \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN(d,state) \
	BOOST_PP_WHILE_ ## d \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_PRED, \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_OP, \
		BOOST_PP_TUPLE_PUSH_BACK \
			( \
			BOOST_PP_TUPLE_PUSH_BACK \
				( \
				state, \
				BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN_TUPLE_TYPES(d,state) \
				), \
			0 \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_ID_LOOP(d,state) \
	BOOST_PP_WHILE_ ## d \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_PRED, \
		BOOST_VMD_DETAIL_SEQUENCE_INNER_OP, \
		BOOST_PP_TUPLE_PUSH_BACK(BOOST_PP_TUPLE_PUSH_BACK(state,((NUMBER,0),(IDENTIFIER,1))),0) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_ID_EL(d,state) \
	( \
	BOOST_VMD_AFTER_LIST_D(d,BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state)), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT_ADD(state,(BOOST_VMD_TYPE_LIST,BOOST_PP_NIL)), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
	) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_ID(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY_LIST \
			( \
			BOOST_VMD_BEGIN_IDENTIFIER \
				( \
				BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state) \
				) \
			), \
		BOOST_VMD_DETAIL_SEQUENCE_OP_ID_EL, \
		BOOST_VMD_DETAIL_SEQUENCE_OP_ID_LOOP \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP_REDUCE_STATE(state) \
	( \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_OUTTYPE(state), \
	BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
	) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_OP(d,state) \
	BOOST_VMD_DETAIL_SEQUENCE_OP_REDUCE_STATE \
		( \
		BOOST_PP_IIF \
			( \
			BOOST_PP_IS_BEGIN_PARENS \
				( \
				BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state) \
				), \
			BOOST_VMD_DETAIL_SEQUENCE_OP_PAREN, \
			BOOST_VMD_DETAIL_SEQUENCE_OP_ID \
			) \
		(d,state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PRED_CELEM_SZ(d,state) \
	BOOST_PP_LESS_EQUAL_D \
		( \
		d, \
		BOOST_PP_SEQ_SIZE(BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state)), \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PRED_CELEM(d,state) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_PRED_ICELEM(d,state)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PRED_ICELEM(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_BITOR \
			( \
			BOOST_VMD_IS_EMPTY \
				( \
				BOOST_VMD_DETAIL_SEQUENCE_STATE_ELEM(state) \
				), \
			BOOST_VMD_IS_EMPTY \
				( \
				BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state) \
				) \
			), \
		BOOST_VMD_IDENTITY(1), \
		BOOST_VMD_DETAIL_SEQUENCE_PRED_CELEM_SZ \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_PRED(d,state) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_SEQUENCE_IPRED(d,state)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_IPRED(d,state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state) \
			), \
		BOOST_VMD_IDENTITY(0), \
		BOOST_VMD_DETAIL_SEQUENCE_PRED_CELEM \
		) \
	(d,state) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_EMPTY_TYPE_CHECK(output) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_EQUAL(output,BOOST_VMD_TYPE_ARRAY), \
		(0,()), \
		BOOST_PP_NIL \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_EMPTY_TYPE(output) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_BITOR \
			( \
			BOOST_PP_EQUAL(output,BOOST_VMD_TYPE_SEQ), \
			BOOST_PP_EQUAL(output,BOOST_VMD_TYPE_TUPLE) \
			), \
		BOOST_VMD_EMPTY, \
		BOOST_VMD_DETAIL_SEQUENCE_EMPTY_TYPE_CHECK \
		) \
	(output) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_GET(state) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_AFTER \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_FROM(state) \
			), \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state), \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_INPUT(state) \
			), \
			BOOST_VMD_DETAIL_SEQUENCE_STATE_RESULT(state) \
		) 
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE(vseq,elem,output,from) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_GET \
		( \
		BOOST_PP_WHILE \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_PRED, \
			BOOST_VMD_DETAIL_SEQUENCE_OP, \
				( \
				vseq, \
				BOOST_VMD_DETAIL_SEQUENCE_EMPTY_TYPE \
					( \
					output \
					), \
				elem, \
				output, \
				from \
				) \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_D(d,vseq,elem,output,from) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_GET \
		( \
		BOOST_PP_WHILE_ ## d \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_PRED, \
			BOOST_VMD_DETAIL_SEQUENCE_OP, \
				( \
				vseq, \
				BOOST_VMD_DETAIL_SEQUENCE_EMPTY_TYPE \
					( \
					output \
					), \
				elem, \
				output, \
				from \
				) \
			) \
		) \
/**/

/*--------------------------------------------------------------------------------------------------------------------------*/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_ONLY_CHELM(seq,elem) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_GREATER(BOOST_PP_SEQ_SIZE(seq),elem), \
		BOOST_PP_SEQ_ELEM, \
		BOOST_VMD_EMPTY \
		) \
	(elem,seq) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_AFTER_CHELM_RES(data,elem) \
	( \
	BOOST_PP_SEQ_ELEM(elem,BOOST_PP_TUPLE_ELEM(0,data)), \
	BOOST_PP_TUPLE_ELEM(1,data) \
	) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_AFTER_CHELM(data,elem) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_GREATER(BOOST_PP_SEQ_SIZE(BOOST_PP_TUPLE_ELEM(0,data)),elem), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_AFTER_CHELM_RES, \
		BOOST_VMD_DETAIL_EMPTY_RESULT \
		) \
	(data,elem) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_ONLY(seq,elem) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY(seq), \
		BOOST_VMD_EMPTY, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_ONLY_CHELM \
		) \
	(seq,elem) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_AFTER(data,elem) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(0,data)), \
		BOOST_VMD_DETAIL_EMPTY_RESULT, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_AFTER_CHELM \
		) \
	(data,elem) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ(seq,elem,nm) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_AFTER(nm), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_AFTER, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ_ONLY \
		) \
	(seq,elem) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ENUM_PROCESS(tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY(tuple), \
		BOOST_VMD_EMPTY, \
		BOOST_PP_TUPLE_ENUM \
		) \
	(tuple) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(...) \
	BOOST_PP_VARIADIC_ELEM(0,__VA_ARGS__) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(vseq) \
	BOOST_PP_NOT(BOOST_VMD_IS_EMPTY(vseq)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_PROCESS(elem,vseq,nm) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE \
			( \
			vseq, \
			elem, \
			BOOST_VMD_TYPE_SEQ, \
			nm \
			), \
		elem, \
		nm \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_PROCESS_D(d,elem,vseq,nm) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_FSEQ \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_D \
			( \
			d, \
			vseq, \
			elem, \
			BOOST_VMD_TYPE_SEQ, \
			nm \
			), \
		elem, \
		nm \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY_RES(nm) \
	BOOST_PP_EXPR_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_STATE_IS_AFTER(nm), \
		(,) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY(elem,vseq,nm) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY_RES(nm) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY_D(d,elem,vseq,nm) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY_RES(nm) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM(elem,vseq,nm) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(vseq), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_PROCESS, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY \
		) \
	(elem,vseq,nm) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_D(d,elem,vseq,nm) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(vseq), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_PROCESS_D, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_EMPTY_D \
		) \
	(d,elem,vseq,nm) \
/**/

#define BOOST_VMD_DETAIL_TYPE_TUPLE_SEQUENCE(tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(1,tuple)), \
		BOOST_PP_TUPLE_ELEM(0,BOOST_PP_TUPLE_ELEM(0,tuple)), \
		BOOST_VMD_TYPE_VSEQUENCE \
		) \
/**/

#define BOOST_VMD_DETAIL_TYPE_TUPLE_I(tuple) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(0,tuple)), \
		BOOST_VMD_IDENTITY(BOOST_VMD_TYPE_EMPTY), \
		BOOST_VMD_DETAIL_TYPE_TUPLE_SEQUENCE \
		) \
	(tuple) \
/**/

#define BOOST_VMD_DETAIL_TYPE_TUPLE(tuple) \
	BOOST_VMD_IDENTITY_RESULT(BOOST_VMD_DETAIL_TYPE_TUPLE_I(tuple)) \
/**/

#define BOOST_VMD_DETAIL_TYPE_SINGLE(...) \
	BOOST_VMD_DETAIL_TYPE_TUPLE \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM \
			( \
			BOOST_VMD_ALLOW_ALL, \
			0, \
			__VA_ARGS__, \
			BOOST_VMD_RETURN_AFTER, \
			BOOST_VMD_RETURN_TYPE \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_TYPE_MORE(...) \
	BOOST_VMD_DETAIL_TYPE_TUPLE \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM \
			( \
			BOOST_VMD_ALLOW_ALL, \
			0, \
			BOOST_PP_VARIADIC_ELEM(0,__VA_ARGS__), \
			BOOST_VMD_RETURN_AFTER, \
			BOOST_VMD_RETURN_TYPE, \
			BOOST_VMD_DETAIL_VARIADIC_POP_FRONT(__VA_ARGS__) \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_IS_MULTI_TUPLE(tuple) \
	BOOST_PP_BITNOR \
		( \
		BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(0,tuple)), \
		BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(1,tuple)) \
		) \
/**/

#define BOOST_VMD_DETAIL_IS_UNARY_TUPLE(tuple) \
	BOOST_PP_BITAND \
		( \
		BOOST_PP_NOT \
			( \
			BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(0,tuple)) \
			), \
		BOOST_VMD_IS_EMPTY(BOOST_PP_TUPLE_ELEM(1,tuple)) \
		) \
/**/

/*--------------------------------------------------------------------------------------------------------------------------*/

// ELEM

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM(allow,elem,...) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM \
		( \
		elem, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
		BOOST_VMD_DETAIL_NEW_MODS(allow,__VA_ARGS__) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ELEM_D(d,allow,elem,...) \
	BOOST_VMD_DETAIL_SEQUENCE_ELEM_NM_D \
		( \
		d, \
		elem, \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
		BOOST_VMD_DETAIL_NEW_MODS(allow,__VA_ARGS__) \
		) \
/**/

// AFTER

#define BOOST_VMD_DETAIL_SEQUENCE_AFTER(elem,vseq) \
	BOOST_PP_TUPLE_ELEM(1,BOOST_VMD_DETAIL_SEQUENCE_ELEM(BOOST_VMD_ALLOW_AFTER,elem,vseq,BOOST_VMD_RETURN_AFTER)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_AFTER_D(d,elem,vseq) \
	BOOST_PP_TUPLE_ELEM(1,BOOST_VMD_DETAIL_SEQUENCE_ELEM_D(d,BOOST_VMD_ALLOW_AFTER,elem,vseq,BOOST_VMD_RETURN_AFTER)) \
/**/

// SIZE

#define BOOST_VMD_DETAIL_SEQUENCE_SIZE(vseq) \
	BOOST_PP_ARRAY_SIZE(BOOST_VMD_DETAIL_SEQUENCE_TO_ARRAY(vseq)) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_SIZE_D(d,vseq) \
	BOOST_PP_ARRAY_SIZE(BOOST_VMD_DETAIL_SEQUENCE_TO_ARRAY_D(d,vseq)) \
/**/

// ARRAY

#define BOOST_VMD_DETAIL_SEQUENCE_TO_ARRAY(...) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_ARRAY, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			), \
		(0,()) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_TO_ARRAY_D(d,...) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_D \
			( \
			d, \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_ARRAY, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			), \
		(0,()) \
		) \
/**/

// LIST

#define BOOST_VMD_DETAIL_SEQUENCE_TO_LIST(...) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_LIST, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			), \
		BOOST_PP_NIL \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_TO_LIST_D(d,...) \
	BOOST_PP_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_D \
			( \
			d, \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_LIST, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			), \
		BOOST_PP_NIL \
		) \
/**/

// SEQ

#define BOOST_VMD_DETAIL_SEQUENCE_TO_SEQ(...) \
	BOOST_PP_EXPR_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_SEQ, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_TO_SEQ_D(d,...) \
	BOOST_PP_EXPR_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_D \
			( \
			d, \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_SEQ, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			) \
		) \
/**/

// TUPLE

#define BOOST_VMD_DETAIL_SEQUENCE_TO_TUPLE(...) \
	BOOST_PP_EXPR_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE \
			( \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_TUPLE, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_TO_TUPLE_D(d,...) \
	BOOST_PP_EXPR_IIF \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_NOT_EMPTY(BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__)), \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM_PROCESS_TUPLE_D \
			( \
			d, \
			BOOST_VMD_DETAIL_SEQUENCE_ELEM_GET_VSEQ(__VA_ARGS__), \
			, \
			BOOST_VMD_TYPE_TUPLE, \
			BOOST_VMD_DETAIL_NEW_MODS(BOOST_VMD_ALLOW_RETURN,__VA_ARGS__) \
			) \
		) \
/**/

// ENUM

#define BOOST_VMD_DETAIL_SEQUENCE_ENUM(...) \
	BOOST_VMD_DETAIL_SEQUENCE_ENUM_PROCESS \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_TO_TUPLE(__VA_ARGS__) \
		) \
/**/

#define BOOST_VMD_DETAIL_SEQUENCE_ENUM_D(d,...) \
	BOOST_VMD_DETAIL_SEQUENCE_ENUM_PROCESS \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_TO_TUPLE_D(d,__VA_ARGS__) \
		) \
/**/

// UNARY

#define BOOST_VMD_DETAIL_IS_UNARY(vseq) \
	BOOST_VMD_DETAIL_IS_UNARY_TUPLE \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM(BOOST_VMD_ALLOW_AFTER,0,vseq,BOOST_VMD_RETURN_AFTER) \
		) \
/**/

// MULTI

#define BOOST_VMD_DETAIL_IS_MULTI(vseq) \
	BOOST_VMD_DETAIL_IS_MULTI_TUPLE \
		( \
		BOOST_VMD_DETAIL_SEQUENCE_ELEM(BOOST_VMD_ALLOW_AFTER,0,vseq,BOOST_VMD_RETURN_AFTER) \
		) \
/**/

#define BOOST_VMD_DETAIL_TYPE(...) \
	BOOST_PP_IIF \
		( \
		BOOST_PP_EQUAL(BOOST_PP_VARIADIC_SIZE(__VA_ARGS__),1), \
		BOOST_VMD_DETAIL_TYPE_SINGLE, \
		BOOST_VMD_DETAIL_TYPE_MORE \
		) \
	(__VA_ARGS__) \
/**/

#endif /* BOOST_VMD_DETAIL_SEQUENCE_HPP */
