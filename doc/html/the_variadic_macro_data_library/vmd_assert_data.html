<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Verifying Boost PP data types</title>
<link rel="stylesheet" href="../../../../../doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;The Variadic Macro Data Library 1.6">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;The Variadic Macro Data Library 1.6">
<link rel="prev" href="vmd_test_parens.html" title="Testing and removing parens">
<link rel="next" href="vmd_internal_macros.html" title="Controlling internal usage">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../boost.png"></td>
<td align="center"><a href="../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="vmd_test_parens.html"><img src="../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="vmd_internal_macros.html"><img src="../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="the_variadic_macro_data_library.vmd_assert_data"></a><a class="link" href="vmd_assert_data.html" title="Verifying Boost PP data types">Verifying
    Boost PP data types</a>
</h2></div></div></div>
<p>
      There is no way to determine whether a macro parameter is a given Boost PP
      data type. But one can come close to this functionality using variadic macros
      and the test for emptiness in the VMD library which the BOOST_VMD_IS_EMPTY
      macro gives. Therefore I have developed four macros, for each of the four Boost
      PP data types, which will produce a compiler error if a parameter is not a
      given data type, else will output nothing. These macros are:
    </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
          <code class="computeroutput"><a class="link" href="../BOOST_VMD_ASSERT_IS_ARRAY.html" title="Macro BOOST_VMD_ASSERT_IS_ARRAY">BOOST_VMD_ASSERT_IS_ARRAY</a></code>(param),
          asserts that 'param' is a Boost PP array
        </li>
<li class="listitem">
          <code class="computeroutput"><a class="link" href="../BOOST_VMD_ASSERT_IS_LIST.html" title="Macro BOOST_VMD_ASSERT_IS_LIST">BOOST_VMD_ASSERT_IS_LIST</a></code>(param),
          asserts that 'param' is a Boost PP list
        </li>
<li class="listitem">
          <code class="computeroutput"><a class="link" href="../BOOST_VMD_ASSERT_IS_SEQ.html" title="Macro BOOST_VMD_ASSERT_IS_SEQ">BOOST_VMD_ASSERT_IS_SEQ</a></code>(param),
          asserts that 'param' is a Boost PP seq
        </li>
<li class="listitem">
          <code class="computeroutput"><a class="link" href="../BOOST_VMD_ASSERT_IS_TUPLE.html" title="Macro BOOST_VMD_ASSERT_IS_TUPLE">BOOST_VMD_ASSERT_IS_TUPLE</a></code>(param),
          asserts that 'param' is a Boost PP tuple
        </li>
</ol></div>
<p>
      Each of these act like a C++ assert-like macro. They output nothing if the
      'param' is of the known type, else produce a compiler error. Furthermore these
      macros, like 'assert-like' macros, only check their 'param' in debug mode.
      This, however, can be overridden by the BOOST_VMD_ASSERT_DATA macro. If it
      is defined and set to 1, the macros will always check their 'param', otherwise
      if it is set to 0 the 'param' is never checked.
    </p>
<p>
      The assert macros can be used in code to test whether a 'param' is of the expected
      Boost PP data type. It is not possible to create equivalent macros which return
      1 when the 'param' is of the correct type, else return 0, because of the assert
      macros' necessary reliance on BOOST_VMD_IS_EMPTY, which even in the best of
      conditions is slightly flawed. However the flaw in BOOST_VMD_IS_EMPTY, where
      a function-like macro name could produce a compiler error, is made use of in
      the assert macros so that the compiler error produced in that case will only
      occur when the assert macro verifies that its 'param' is not the Boost PP data
      type being checked. Still there is the very slight flaw in the assert macros
      where its reliance on BOOST_VMD_IS_EMPTY could run into input being checked
      where a function-like macro name will produce the incorrect result from the
      BOOST_VMD_IS_EMPTY macro when using VC++. However this flaw is thought to be
      so slight, and an end-user's chance of inputting such data so minimal, that
      it was felt that such assert-like macros would be beneficial to macro programmers
      using Boost PP and VMD.
    </p>
<p>
      Another point to be made is that Boost PP array and list are also tuples. So
      passing an array or list to BOOST_VMD_ASSERT_IS_TUPLE will assert that either
      one of those Boost PP data types is a valid tuple by not producing a compiler
      error.
    </p>
<p>
      A final point concerns using the assert macros with Visual C++. There is no
      way which I have been able to discover to produce a compiler error from within
      a macro using Visual C++ without producing invalid C++ output to trigger the
      error. If the VC++ compiler subsequently sees this output after the preprocessing
      stage is complete it will create an error message.
    </p>
<p>
      Because of this the promise to produce no output in case of error from the
      assert macros must be amended for Visual C++. The compiler error when using
      Visual C++, and an assert macro fails, could be masked by using one of the
      assert macros in a situation where no output is generated by an enclosing macro.
      This case would occur if the result of one of the assert macros were embedded
      in another macro, and the embedded macro just ignores any "output"
      from VC++ when the assert macro fails. An admittedly artifical example using
      VC++ might be:
    </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">vmd</span><span class="special">/</span><span class="identifier">vmd_assert_is_tuple</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="preprocessor">#define</span> <span class="identifier">IGNORE_TUPLE_CHECK</span><span class="special">(</span><span class="identifier">vcoutput</span><span class="special">)</span>
<span class="preprocessor">#define</span> <span class="identifier">USE_TUPLE</span><span class="special">(</span><span class="identifier">atuple</span><span class="special">)</span> <span class="identifier">IGNORE_TUPLE_CHECK</span><span class="special">(</span><span class="identifier">BOOST_VMD_ASSERT_TUPLE</span><span class="special">(</span><span class="identifier">atuple</span><span class="special">))</span> <span class="identifier">PROCESS_TUPLE</span><span class="special">(</span><span class="identifier">atuple</span><span class="special">)</span>
</pre>
<p>
      When USE_TUPLE is invoked using VC++, if the input is not actually a Boost
      PP tuple BOOST_VMD_ASSERT_TUPLE will output incorrect C++. But since that incorrect
      output is passed to another macro which just ignores it, the output will never
      appear after the preprocessing stage so no compiler error will occur.
    </p>
<p>
      Individual header files can be used for each of the assert macros instead of
      including the general header file 'vmd.hpp'. The individual header files are:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
          'vmd_assert_is_array.hpp' for the BOOST_VMD_ASSERT_IS_ARRAY macro
        </li>
<li class="listitem">
          'vmd_assert_is_list.hpp' for the BOOST_VMD_ASSERT_IS_LIST macro
        </li>
<li class="listitem">
          'vmd_assert_is_seq.hpp' for the BOOST_VMD_ASSERT_IS_SEQ macro
        </li>
<li class="listitem">
          'vmd_assert_is_tuple.hpp' for the BOOST_VMD_ASSERT_IS_TUPLE macro.
        </li>
</ul></div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2010-2013 Tropic
      Software East Inc</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="vmd_test_parens.html"><img src="../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="vmd_internal_macros.html"><img src="../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
